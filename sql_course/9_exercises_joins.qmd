---
title: "Oefeningen tennis joins"
author: Danny Volkaerts
date: last-modified
date-format: "DD MMM, YYYY" 
smaller: true
format:
  revealjs: 
    theme: default
filters:
  - interactive-sql
resources: 
  - sql_course_docs/sql-server-cheat-sheet-a4.pdf
databases:
  - name: tennis
    path: "https://raw.githubusercontent.com/dannyvolkaerts/something/main/tennis.sql"
  - name: ruimte
    path: "https://raw.githubusercontent.com/dannyvolkaerts/something/main/ruimtereizen.sqlite"
---


## De Tennisvereniging

![](sql_course_images/tennis_DB.png)

---

### Algemene informatie

Algemene info over dit database schema kan je [hier](Tennis_uitleg.html) vinden.

![Watterson, Calvin and Hobbes](sql_course_images/Calvin_and_Hobbes_playing_Calvinball.jpg){width=50%}

---

## JOINS (H3)

---

### Oefening 1

Maak een lijst van alle boetes en voeg de naam van de speler toe (naam en eerste letter(s) in één kolom).

``` {.sql .interactive .tennis}

```

:::{.notes}
SELECT b.betalingsnr, b.spelersnr, s.naam || ' ' || s.voorletters AS naam, b.datum, b.bedrag\
FROM boetes b INNER JOIN spelers s ON b.spelersnr = s.spelersnr\
:::

---

### Oefening 2

Geef een overzicht van alle bestuursleden die nu in functie zijn. Toon hun functie. Geef ook hun namen (naam en voorletters in één kolom).

``` {.sql .interactive .tennis}

```

:::{.notes}
SELECT b.spelersnr, s.naam || ' ' || s.voorletters AS naam, b.begin_datum, b.functie\
FROM bestuursleden b INNER JOIN spelers s ON b.spelersnr = s.spelersnr\
WHERE eind_datum IS null\
:::

---

### Oefening 3

Geef een overzicht van alle boetes groter dan € 30. Toon het bedrag in eurocent. Geef ook het spelersnummer en de naam van de speler die de boete kreeg.

``` {.sql .interactive .tennis}

```

:::{.notes}
SELECT b.spelersnr, s.naam, round(bedrag*100) AS "bedrag in centen"\
FROM boetes b INNER JOIN spelers s ON b.spelersnr = s.spelersnr AND bedrag > 30\
:::

---

### Oefening 4

Maak een lijst van alle gewonnen wedstrijden gespeeld door leden van team 2. Toon het spelersnr van de winnende speler en ook het nummer van de kapitein van het team.

``` {.sql .interactive .tennis}

```

:::{.notes}
SELECT w.wedstrijdnr, w.spelersnr, w.teamnr, t.spelersnr AS captain\
FROM wedstrijden w INNER JOIN teams t ON w.teamnr = t.teamnr\
WHERE w.teamnr = 2 AND gewonnen-verloren > 0\
:::

---

### Oefening 5

Toon naam en voorletters (in 1 kolom), team en divisie van de kapitein van elk team.

``` {.sql .interactive .tennis}

```

:::{.notes}
SELECT t.teamnr,t.spelersnr, s.naam || ' ' || s.voorletters AS kapitein, t.divisie
FROM teams t INNER JOIN spelers s ON t.spelersnr = s.spelersnr
:::

---

### MOEILIJKER

---

### Oefening 6

Geef een lijst met het spelersnummer, de naam van de speler, de datum van de boete en het bedrag van de boete van al de spelers die een boete gekregen hebben met een bedrag groter dan € 45,50 en in Rijswijk wonen. Sorteer op spelersnr en het volgnummer van de boete.

``` {.sql .interactive .tennis}

```

:::{.notes}
SELECT spelers.spelersnr, spelers.naam, boetes.datum, boetes.bedrag\
FROM spelers INNER JOIN boetes ON spelers.spelersnr = boetes.spelersnr\
WHERE boetes.bedrag > 45.50 AND spelers.plaats = 'Rijswijk'\
ORDER BY spelers.spelersnr, boetes.betalingsnr;\
:::

---

### Oefening 7

Geef voor elke wedstrijd het wedstrijdnummer en de volledige naam van de aanvoerder van het team waarvoor de wedstrijd werd gespeeld. Sorteer je resultaat volgens het wedstrijdnummer in oplopende volgorde. TIP: je zal hier een JOIN moeten doen met meer dan twee tabellen.

``` {.sql .interactive .tennis}

```

:::{.notes}
SELECT W.wedstrijdnr, T.spelersnr, naam, voorletters\
FROM wedstrijden W INNER JOIN teams T on W.teamnr = T.teamnr\
  INNER JOIN spelers S on T.spelersnr = S.spelersnr\
ORDER BY 1\
:::

---

### Oefening 8

Geef het gemiddeld boetebedrag per speler, afgerond op twee cijfers na de komma. Spelers zonder boete krijgen als waarde ‘geen boetes’. Sorteer op spelersnaam.

``` {.sql .interactive .tennis}

```

:::{.notes}
SELECT spelers.naam,\
  CASE\
    WHEN AVG(boetes.bedrag) IS NULL THEN 'geen boetes'\
    ELSE CAST(ROUND(AVG(boetes.bedrag), 2) AS varchar(8))\
  END AS gemiddeld\
FROM spelers LEFT OUTER JOIN boetes ON spelers.spelersnr = boetes.spelersnr\
GROUP BY spelers.spelersnr, spelers.naam\
ORDER BY 1\
:::

---

### Oefening 9

Geef het gemiddeld aantal gewonnen en verloren sets per geboortejaar. Rond telkens af op twee cijfers na de komma. Sorteer op geboortejaar zodat de gegevens van de jongste spelers bovenaan staan.

``` {.sql .interactive .tennis}

```

:::{.notes}
SELECT EXTRACT(YEAR FROM geb_datum) AS geboortejaar, ROUND(AVG(gewonnen),2) AS gewonnen,\
  ROUND(AVG(verloren),2) AS verloren\
FROM wedstrijden W INNER JOIN spelers S ON W.spelersnr = S.spelersnr\
GROUP BY EXTRACT(YEAR FROM geb_datum)\
ORDER BY geboortejaar DESC; \
:::

---

### Oefening 10

Geef voor de actieve bestuursleden zonder boete hun laatste gespeelde wedstrijd (die met het hoogste wedstrijdnummer). Sorteer aflopend op spelersnr.

``` {.sql .interactive .tennis}

```

:::{.notes}
SELECT bestuursleden.spelersnr, MAX(wedstrijden.wedstrijdnr) AS laatstewedstrijd\
FROM bestuursleden\
  INNER JOIN wedstrijden ON bestuursleden.spelersnr = wedstrijden.spelersnr AND\
        bestuursleden.eind_datum IS NULL\
  LEFT OUTER JOIN boetes ON bestuursleden.spelersnr = boetes.spelersnr\
WHERE boetes.spelersnr IS NULL\
GROUP BY bestuursleden.spelersnr\
ORDER BY spelersnr DESC; \
:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

### Oefening 3

Geef een overzicht van alle gewonnen tenniswedstrijden.

``` {.sql .interactive .tennis}

```

:::{.notes}

:::

---

















