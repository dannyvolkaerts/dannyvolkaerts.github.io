<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Danny Volkaerts">

<title>Oefeningen advanced</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/interactive-sql-1.0.0/interactive-sql.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://unpkg.com/@antonz/sqlite@3.40.0/dist/sqlite3.js"></script>
<script src="https://unpkg.com/sqlime@0.1.3/dist/sqlime-db.js"></script>
<script src="https://unpkg.com/sqlime@0.1.3/dist/sqlime-examples.js"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../sql_course/index_sql.html"> 
<span class="menu-text">SQL cursus</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#de-tennisvereniging" id="toc-de-tennisvereniging" class="nav-link active" data-scroll-target="#de-tennisvereniging">De Tennisvereniging</a>
  <ul class="collapse">
  <li><a href="#algemene-informatie" id="toc-algemene-informatie" class="nav-link" data-scroll-target="#algemene-informatie">Algemene informatie</a></li>
  <li><a href="#oefening-1" id="toc-oefening-1" class="nav-link" data-scroll-target="#oefening-1">Oefening 1</a></li>
  <li><a href="#oefening-2" id="toc-oefening-2" class="nav-link" data-scroll-target="#oefening-2">Oefening 2</a></li>
  <li><a href="#oefening-3" id="toc-oefening-3" class="nav-link" data-scroll-target="#oefening-3">Oefening 3</a></li>
  <li><a href="#oefening-4" id="toc-oefening-4" class="nav-link" data-scroll-target="#oefening-4">Oefening 4</a></li>
  <li><a href="#oefening-5" id="toc-oefening-5" class="nav-link" data-scroll-target="#oefening-5">Oefening 5</a></li>
  <li><a href="#oefening-6" id="toc-oefening-6" class="nav-link" data-scroll-target="#oefening-6">Oefening 6</a></li>
  <li><a href="#oefening-7" id="toc-oefening-7" class="nav-link" data-scroll-target="#oefening-7">Oefening 7</a></li>
  <li><a href="#oefening-8---moeilijk" id="toc-oefening-8---moeilijk" class="nav-link" data-scroll-target="#oefening-8---moeilijk">Oefening 8 - moeilijk</a></li>
  <li><a href="#oefening-9" id="toc-oefening-9" class="nav-link" data-scroll-target="#oefening-9">Oefening 9</a></li>
  <li><a href="#oefening-10" id="toc-oefening-10" class="nav-link" data-scroll-target="#oefening-10">Oefening 10</a></li>
  <li><a href="#oefening-11" id="toc-oefening-11" class="nav-link" data-scroll-target="#oefening-11">Oefening 11</a></li>
  <li><a href="#oefening-12" id="toc-oefening-12" class="nav-link" data-scroll-target="#oefening-12">Oefening 12</a></li>
  <li><a href="#oefening-13" id="toc-oefening-13" class="nav-link" data-scroll-target="#oefening-13">Oefening 13</a></li>
  <li><a href="#oefening-14" id="toc-oefening-14" class="nav-link" data-scroll-target="#oefening-14">Oefening 14</a></li>
  <li><a href="#oefening-15" id="toc-oefening-15" class="nav-link" data-scroll-target="#oefening-15">Oefening 15</a></li>
  <li><a href="#oefening-16" id="toc-oefening-16" class="nav-link" data-scroll-target="#oefening-16">Oefening 16</a></li>
  <li><a href="#oefening-17" id="toc-oefening-17" class="nav-link" data-scroll-target="#oefening-17">Oefening 17</a></li>
  <li><a href="#oefening-18" id="toc-oefening-18" class="nav-link" data-scroll-target="#oefening-18">Oefening 18</a></li>
  <li><a href="#oefening-19" id="toc-oefening-19" class="nav-link" data-scroll-target="#oefening-19">Oefening 19</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="10_exercises_advanced.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Oefeningen advanced</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Danny Volkaerts </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">02 Jun, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="de-tennisvereniging" class="level2">
<h2 class="anchored" data-anchor-id="de-tennisvereniging">De Tennisvereniging</h2>
<p><img src="sql_course_images/tennis_DB.png" class="img-fluid"></p>
<hr>
<section id="algemene-informatie" class="level3">
<h3 class="anchored" data-anchor-id="algemene-informatie">Algemene informatie</h3>
<p>Algemene info over dit database schema kan je <a href="Tennis_uitleg.html">hier</a> vinden.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="sql_course_images/Calvin_and_Hobbes_playing_Calvinball.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Watterson, Calvin and Hobbes</figcaption>
</figure>
</div>
<hr>
</section>
<section id="oefening-1" class="level3">
<h3 class="anchored" data-anchor-id="oefening-1">Oefening 1</h3>
<p>Maak een overzicht waarbij je per woonplaats aangeeft hoeveel spelers er wonen in die gemeente.Sorteer op plaats.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb1"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT plaats, COUNT(*) AS aantal<br>
FROM spelers<br>
GROUP BY plaats<br>
ORDER BY plaats;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-2" class="level3">
<h3 class="anchored" data-anchor-id="oefening-2">Oefening 2</h3>
<p>Ga na hoeveel mannelijke en hoeveel vrouwelijke spelers de club telt. Zorg ervoor dat je lijst gesorteerd wordt van het grootst aantal spelers naar het kleinste aantal.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb2"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT geslacht, COUNT(*) AS aantal<br>
FROM spelers<br>
GROUP BY geslacht<br>
ORDER BY aantal DESC;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-3" class="level3">
<h3 class="anchored" data-anchor-id="oefening-3">Oefening 3</h3>
<p>Geef een lijst met het totaalbedrag aan boetes per speler. Sorteer het hoogste totale boetebedrag bovenaan.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb3"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT spelersnr, SUM(bedrag) AS totaalboetebedrag<br>
FROM boetes<br>
GROUP BY spelersnr<br>
ORDER BY totaalboetebedrag DESC;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-4" class="level3">
<h3 class="anchored" data-anchor-id="oefening-4">Oefening 4</h3>
<p>Geef een lijst met voor elke speler met een boete, het totaal bedrag aan boetes. Als het aantal boetes echter groter is dan 2, zet je ‘veel boetes’. Bij de andere spelers zet je een -. Sorteer op aantal boetes aflopend en daarna op totaal boetebedrag aflopend.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb4"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT spelersnr, SUM(bedrag) AS totaalboetebedrag,<br>
CASE<br>
WHEN COUNT(bedrag) &gt; 2 THEN ‘veel boetes’<br>
ELSE ‘-’<br>
END<br>
AS status<br>
FROM boetes<br>
GROUP BY spelersnr<br>
ORDER BY COUNT(bedrag) DESC, SUM(bedrag) DESC;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-5" class="level3">
<h3 class="anchored" data-anchor-id="oefening-5">Oefening 5</h3>
<p>Geef per team, waarvoor wedstrijden gespeeld zijn, het gemiddeld aantal gewonnen en verloren sets. Rond de gemiddelden af tot op twee cijfers na de komma. Sorteer op teamnr.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb5"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT w.teamnr,<br>
ROUND(AVG(CAST(w.gewonnen as decimal)),2) as gem_gewonnen,<br>
ROUND(AVG(CAST(w.verloren AS decimal)),2) as gem_verloren<br>
FROM wedstrijden w<br>
GROUP BY w.teamnry<br>
ORDER BY w.teamnr<br>
</p>
</div>
<hr>
</section>
<section id="oefening-6" class="level3">
<h3 class="anchored" data-anchor-id="oefening-6">Oefening 6</h3>
<p>Geef alle spelers die meer dan één wedstrijd gewonnen hebben.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb6"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT spelers.spelersnr, spelers.naam<br>
FROM wedstrijden, spelers<br>
WHERE wedstrijden.spelersnr = spelers.spelersnr<br>
AND wedstrijden.gewonnen &gt; wedstrijden.verloren<br>
GROUP BY spelers.spelersnr, spelers.naam<br>
HAVING COUNT(*) &gt; 1<br>
</p>
</div>
<hr>
</section>
<section id="oefening-7" class="level3">
<h3 class="anchored" data-anchor-id="oefening-7">Oefening 7</h3>
<p>Geef voor alle actieve bestuursleden die al een boete gehad hebben van meer dan 50 euro hun maximale boetebedrag. Gebruik geen DISTINCT.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb7"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT bestuursleden.spelersnr, MAX(boetes.bedrag)<br>
AS maximum<br>
FROM boetes, bestuursleden<br>
WHERE boetes.spelersnr = bestuursleden.spelersnr<br>
AND bestuursleden.eind_datum IS NULL<br>
GROUP BY bestuursleden.spelersnr<br>
HAVING MAX(boetes.bedrag) &gt; 50;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-8---moeilijk" class="level3">
<h3 class="anchored" data-anchor-id="oefening-8---moeilijk">Oefening 8 - moeilijk</h3>
<p>Sorteer de teams in functie van het aantal verloren wedstrijden (oplopend). Als het aantal verloren wedstrijden gelijk is, sorteer je op het totaal aantal gewonnen sets (aflopend) en op divisienaam (oplopend). Een wedstrijd die verloren werd met 3 - 0 telt niet mee in deze output. Geef het aantal wedstrijden dat voldoet aan bovenstaande voorwaarde mee in de output.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb8"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT teams.divisie, COUNT(*) AS aantal<br>
FROM wedstrijden, teams<br>
WHERE wedstrijden.teamnr = teams.teamnr<br>
AND wedstrijden.verloren &gt; wedstrijden.gewonnen<br>
AND NOT (wedstrijden.verloren = 3 AND<br>
wedstrijden.gewonnen = 0)<br>
GROUP BY teams.divisie<br>
ORDER BY aantal, SUM(wedstrijden.gewonnen) DESC,<br>
teams.divisie;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-9" class="level3">
<h3 class="anchored" data-anchor-id="oefening-9">Oefening 9</h3>
<p>Geef de teams en het aantal verschillende spelers dat voor dit team gespeeld heeft. Sorteer op divisie.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb9"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT teams.divisie, COUNT(DISTINCT wedstrijden.spelersnr) AS aantal<br>
FROM wedstrijden, teams<br>
WHERE wedstrijden.teamnr = teams.teamnr<br>
GROUP BY teams.divisie<br>
ORDER BY teams.divisie;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-10" class="level3">
<h3 class="anchored" data-anchor-id="oefening-10">Oefening 10</h3>
<p>Geef de teams (het nummer van het team en de divisie) waarvoor meer dan vier verschillende spelers gespeeld hebben.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb10"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT teams.teamnr, teams.divisie<br>
FROM wedstrijden, teams<br>
WHERE wedstrijden.teamnr = teams.teamnr<br>
GROUP BY teams.teamnr, teams.divisie<br>
HAVING COUNT(DISTINCT wedstrijden.spelersnr) &gt; 4;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-11" class="level3">
<h3 class="anchored" data-anchor-id="oefening-11">Oefening 11</h3>
<p>Maak een lijst met per spelersnummer het aantal wedstrijden dat een speler verloren heeft op voorwaarde dat deze speler meer dan één wedstrijd verloren heeft. Bijkomend moet de lijst gesorteerd worden op basis van het spelersnummer.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb11"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT spelersnr, COUNT(<em>) AS aantal<br>
FROM wedstrijden<br>
WHERE gewonnen &lt; verloren<br>
GROUP BY spelersnr<br>
HAVING COUNT(</em>) &gt; 1<br>
ORDER BY spelersnr;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-12" class="level3">
<h3 class="anchored" data-anchor-id="oefening-12">Oefening 12</h3>
<p>Geef een lijst met de spelers die ooit bestuurslid zijn geweest (of nog steeds zijn) en niet in Den Haag of Zoetermeer wonen. Bijkomend mag deze speler maximaal 2 keer in het bestuur van de club gezeteld hebben. De lijst moet aflopend gesorteerd worden op het aantal maal dat de betreffende speler in het bestuur zetelde. Mensen met hetzelfde aantal keren moeten oplopend gesorteerd worden op basis van hun spelersnr.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb12"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT spelers.naam, COUNT(<em>) AS aantal<br>
FROM spelers, bestuursleden<br>
WHERE bestuursleden.spelersnr = spelers.spelersnr<br>
AND plaats NOT IN (‘Den Haag’, ‘Zoetermeer’)<br>
GROUP BY spelers.spelersnr, spelers.naam<br>
HAVING COUNT(</em>) &lt;= 2<br>
ORDER BY aantal DESC, spelers.spelersnr;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-13" class="level3">
<h3 class="anchored" data-anchor-id="oefening-13">Oefening 13</h3>
<p>Geef het gemiddeld aantal gewonnen en verloren sets per geboortejaar. Sorteer op geboortejaar.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb13"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT strftime(‘%Y’, geb_datum) AS geboortejaar, AVG(gewonnen) AS gewonnen, AVG(verloren) AS verloren FROM wedstrijden INNER JOIN spelers ON (wedstrijden.spelersnr = spelers.spelersnr) GROUP BY strftime(‘%Y’, geb_datum) ORDER BY geboortejaar</p>
</div>
<hr>
</section>
<section id="oefening-14" class="level3">
<h3 class="anchored" data-anchor-id="oefening-14">Oefening 14</h3>
<p>Geef spelers die in het jaar dat ze lid geworden zijn van de club reeds een boete van meer dan 50 euro gekregen hebben en de som van al deze boetes groter of gelijk is aan 100 euro. Geef buiten de voorletters en de naam van de speler ook het aantal boetes die aan bovenstaande voorwaarden voldoen. Sorteer op spelersnr.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb14"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT spelers.voorletters, spelers.naam, COUNT(*) AS aantalboetes<br>
FROM spelers, boetes<br>
WHERE spelers.spelersnr = boetes.spelersnr<br>
AND boetes.bedrag &gt; 50 AND strftime(‘%Y’,boetes.datum) = spelers.jaartoe<br>
GROUP BY spelers.spelersnr, spelers.voorletters, spelers.naam<br>
HAVING SUM(bedrag) &gt;= 100<br>
ORDER BY spelers.spelersnr;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-15" class="level3">
<h3 class="anchored" data-anchor-id="oefening-15">Oefening 15</h3>
<p>Geef het gemiddeld boetebedrag per speler, afgerond op twee cijfers na de komma. Spelers zonder boete krijgen als waarde ‘geen boetes’. Sorteer op spelersnaam.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb15"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT spelers.naam,<br>
CASE<br>
WHEN AVG(boetes.bedrag) IS NULL THEN ‘geen boetes’<br>
ELSE CAST(ROUND(AVG(boetes.bedrag), 2) AS varchar(8))<br>
END AS gemiddeld<br>
FROM spelers LEFT OUTER JOIN boetes ON spelers.spelersnr = boetes.spelersnr<br>
GROUP BY spelers.spelersnr, spelers.naam<br>
ORDER BY 1<br>
</p>
</div>
<hr>
</section>
<section id="oefening-16" class="level3">
<h3 class="anchored" data-anchor-id="oefening-16">Oefening 16</h3>
<p>Geef het gemiddeld aantal gewonnen en verloren sets per geboortejaar. Rond telkens af op twee cijfers na de komma. Sorteer op geboortejaar zodat de gegevens van de jongste spelers bovenaan staan.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb16"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT strftime(‘%Y’, geb_datum) AS geboortejaar, ROUND(AVG(gewonnen),2) AS gewonnen,<br>
ROUND(AVG(verloren),2) AS verloren<br>
FROM wedstrijden W INNER JOIN spelers S ON W.spelersnr = S.spelersnr<br>
GROUP BY strftime(‘%Y’,geb_datum)<br>
ORDER BY geboortejaar DESC;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-17" class="level3">
<h3 class="anchored" data-anchor-id="oefening-17">Oefening 17</h3>
<p>Geef voor de actieve bestuursleden zonder boete hun laatste gespeelde wedstrijd (die met het hoogste wedstrijdnummer). Sorteer aflopend op spelersnr.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb17"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT bestuursleden.spelersnr, MAX(wedstrijden.wedstrijdnr) AS laatste_wedstrijd<br>
FROM bestuursleden<br>
INNER JOIN wedstrijden ON bestuursleden.spelersnr = wedstrijden.spelersnr AND<br>
bestuursleden.eind_datum IS NULL<br>
LEFT OUTER JOIN boetes ON bestuursleden.spelersnr = boetes.spelersnr<br>
WHERE boetes.spelersnr IS NULL<br>
GROUP BY bestuursleden.spelersnr<br>
ORDER BY bestuursleden.spelersnr DESC;<br>
</p>
</div>
<hr>
</section>
<section id="oefening-18" class="level3">
<h3 class="anchored" data-anchor-id="oefening-18">Oefening 18</h3>
<p>Geef het hoogste wedstrijdnummer voor de teams waarvoor wedstrijden gespeeld zijn door bestuursleden (actief en niet meer actief) die geen boete hebben gekregen. Sorteer op teamnr.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb18"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT teams.teamnr, MAX(wedstrijden.wedstrijdnr) AS laatstewedstrijd FROM teams INNER JOIN wedstrijden on teams.teamnr = wedstrijden.teamnr INNER JOIN bestuursleden ON wedstrijden.spelersnr = bestuursleden.spelersnr LEFT OUTER JOIN boetes ON bestuursleden.spelersnr = boetes.spelersnr WHERE boetes.spelersnr IS NULL GROUP BY teams.teamnr ORDER BY teams.teamnr;</p>
</div>
<hr>
</section>
<section id="oefening-19" class="level3">
<h3 class="anchored" data-anchor-id="oefening-19">Oefening 19</h3>
<p>Geef alle spelers (nummer) die meer wedstrijden gespeeld hebben dan het aantal wedstrijden dat de huidige voorzitter heeft verloren. De huidige voorzitter komt zelf niet in de lijst voor. Gebruik geen subqueries. Sorteer op spelersnr.</p>
<div class="interactive-sql">
<div class="sourceCode" id="cb19"><pre class="sourceCode sql interactive tennis code-with-copy"><code class="sourceCode sql"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>SELECT spelers.spelersnr FROM spelers INNER JOIN wedstrijden ON spelers.spelersnr = wedstrijden.spelersnr, bestuursleden INNER JOIN wedstrijden voorzitterswedstrijden ON bestuursleden.spelersnr = voorzitterswedstrijden.spelersnr AND voorzitterswedstrijden.gewonnen &lt; voorzitterswedstrijden.verloren WHERE bestuursleden.eind_datum IS NULL AND bestuursleden.functie = ‘Voorzitter’ AND bestuursleden.spelersnr &lt;&gt; spelers.spelersnr GROUP BY spelers.spelersnr HAVING COUNT(DISTINCT wedstrijden.wedstrijdnr) &gt; COUNT(DISTINCT voorzitterswedstrijden.wedstrijdnr) ORDER BY spelers.spelersnr;</p>
</div>


<sqlime-db name="tennis" path="https://raw.githubusercontent.com/dannyvolkaerts/something/main/tennis.sql"></sqlime-db>
<sqlime-examples db="tennis" selector="div.interactive-sql pre.tennis code" editable=""></sqlime-examples>
<sqlime-db name="ruimte" path="https://raw.githubusercontent.com/dannyvolkaerts/something/main/ruimtereizen.sqlite"></sqlime-db>
<sqlime-examples db="ruimte" selector="div.interactive-sql pre.ruimte code" editable=""></sqlime-examples>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<script src="../site_libs/quarto-contrib/interactive-sql-1.0.0/interactive-sql.js"></script>
</body></html>